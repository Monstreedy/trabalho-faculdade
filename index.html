<!DOCTYPE html>
<html lang="pt-br">
<head>
    <link href="https://cdn.jsdelivr.net/npm/daisyui@4.12.13/dist/full.min.css" rel="stylesheet" type="text/css" />
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://unpkg.com/react@18/umd/react.development.js" crossorigin></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.development.js" crossorigin></script>
    <script src="https://unpkg.com/@babel/standalone@7.10.3/babel.min.js" crossorigin></script>
    

    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Hoje no Cinema</title>
    <link rel="stylesheet" href="style.css">
</head>
<body>
    <header>
        <h1>Hoje no Cinema</h1><br>
        <nav>
            <ul>
                <li class=a1><a href="turismo.html">Início</a></li>
                <li class=a2><a href="parque-tangua.html">Parque Tanguá</a></li>
                <li class=a3><a href="jardim-botanico.html">Jardim Botânico</a></li>
                <li class=a4><a href="lago azul.html">Lago Azul</a></li>
                <li class=a5><a href="parque-tingui.html">Parque Tingui</a></li>
                <li class=a6><a href="museu rosa.html">Museu Rosa Cruz</a></li>
                <li class=a6><a href="bar.html">Restaurantes</a></li>
            </ul>
        </nav>
    </header>

    <main class="flex flex-col items-center">
        <div id="root"></div>
        <p class="text-2xl">
            Filmes em cartaz
        </p>
        <div class="divider"></div>
        <div id="movie-list"></div> 
    
        


    </main>   

    <script type="text/babel" data-presets="react,stage-3">
        function MovieItem({title, overview, img}) {
            return (
                <div class="card card-side bg-white shadow-xl">
                    <figure class="!w-1/3 object-contain h-60">
                    <img
                        src={"https://image.tmdb.org/t/p/w300" + img}
                        alt="Movie" />
                    </figure>

                    <div class="card-body">
                        <h2 class="card-title">{title}</h2>
                        <p>{overview}</p>
                        <div class="card-actions justify-end">
                            <button class="btn btn-primary max-w">Ver mais</button>
                        </div>
                    </div>
                </div>
            )
        }

        function MovieList(){
            const [movies, setMovies] = React.useState([]);

            React.useEffect(()=>{
                if(movies.length > 0) return;

                const url = 'https://api.themoviedb.org/3/movie/now_playing?language=pt-BRS&page=1';
                const options = {
                method: 'GET',
                headers: {
                    accept: 'application/json',
                    Authorization: 'Bearer eyJhbGciOiJIUzI1NiJ9.eyJhdWQiOiIwZGExZjgwOGM3YTE4YWVjMWQ1N2FkYjYzMGVjMTIxYSIsIm5iZiI6MTczMjA2ODY4OS42NDYxMTk4LCJzdWIiOiI2NzNkNDI1ZjA3MWJhNmRjZTk5MmIxOGUiLCJzY29wZXMiOlsiYXBpX3JlYWQiXSwidmVyc2lvbiI6MX0.lbuWkIQg-TZJstW2Dm9Hyu7sJOtvVtjDvSB9d-g2AYw'
                }
                };

                fetch(url, options)
                .then(res => res.json())
                .then(data => {
                    setMovies(data.results);  
                })
                .catch(err => console.error(err));
            },[movies])

            return (
                <div id="movie-list" class="px-32 flex flex-col gap-4">
                    { movies.map((movie) => (
                        <MovieItem 
                            key={movie.id}
                            title={movie.title}
                            overview={movie.overview}
                            img={movie.backdrop_path}
                        />
                    ))}
                </div>
            )
        }

        // Render the component to the DOM

        const container = document.getElementById("root")
        const root = ReactDOM.createRoot(container)

        root.render(<MovieList />);
    </script>

</body>
</html>